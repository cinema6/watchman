{
    "name": "development",
    "chef_type": "environment",
    "json_class": "Chef::Environment",
    "description": "Watchman Development Environment",
    "default_attributes": {
        "watchman" : {
            "rsyslog": {
                "monitor": "true",
                "watchman": {
                    "token": "fac240ab-aa03-4430-8966-a474b92773d3"
                },
                "devTimeStreamApplication": {
                    "token": "64ae1c2d-3425-4337-841f-df86e3362ebb"
                },
                "devWatchmanStreamApplication": {
                    "token": "e488a8de-462d-4f59-ad68-f7cf2f268c3d"
                },
                "devCwrxStreamApplication": {
                    "token": "86527b56-b848-4c65-b274-33e09cf2a9eb"
                }
            },
            "deploy": {
                "apps": ["devTimeStreamApplication", "devWatchmanStreamApplication", "devCwrxStreamApplication"]
            },
            "app": {
                "config": {
                    "log": {
                        "logLevel": "trace",
                        "logDir": "/opt/sixxy/logs",
                        "logName": "watchman.log",
                        "media": [ { "type": "file" } ]
                    },
                    "secrets": "/opt/sixxy/.watchman.secrets.json",
                    "appCreds": "/opt/sixxy/.rcAppCreds.json",
                    "cwrx": {
                        "api": {
                            "root": "http://33.33.33.10",
                            "auth": {
                                "endpoint": "/api/auth"
                            },
                            "campaigns": {
                                "endpoint": "/api/campaigns"
                            },
                            "analytics": {
                                "endpoint": "/api/analytics"
                            },
                            "users": {
                                "endpoint": "/api/account/users"
                            },
                            "orgs": {
                                "endpoint": "/api/account/orgs"
                            },
                            "payments": {
                                "endpoint": "/api/payments/"
                            },
                            "promotions": {
                                "endpoint": "/api/promotions"
                            },
                            "transactions": {
                                "endpoint": "/api/transactions"
                            },
                            "accounting": {
                                "endpoint": "/api/accounting"
                            }
                        }
                    },
                    "pidPath": "/opt/sixxy/run",
                    "cloudWatch": {
                        "namespace": "C6/Watchman",
                        "region": "us-east-1",
                        "dimensions": [
                            {
                                "Name": "Environment",
                                "Value": "Development"
                            }
                        ],
                        "sendInterval": 60000
                    },
                    "emails": {
                        "sender": "no-reply@reelcontent.com",
                        "dashboardLinks": {
                            "selfie": "http://localhost:9000/#/apps/selfie/campaigns",
                            "bob": "http://localhost:9000/#/bob/products"
                        },
                        "manageLink": "http://localhost:9000/#/apps/selfie/campaigns/manage/:campId/manage",
                        "reviewLink": "http://localhost:9000/#/apps/selfie/campaigns/manage/:campId/admin",
                        "activationTargets": {
                            "selfie": "http://localhost:9000/#/confirm?selfie=selfie",
                            "bob": "http://localhost:9000/#/bob/confirm"
                        },
                        "supportAddress": "c6e2etester@gmail.com",
                        "passwordResetPages": {
                            "portal": "http://localhost:9000/#/password/forgot",
                            "selfie": "http://localhost:9000/#/pass/forgot?selfie=true"
                        },
                        "forgotTargets": {
                            "portal": "http://localhost:9000/#/password/reset",
                            "selfie": "http://localhost:9000/#/pass/reset?selfie=true"
                        }
                    },
                    "paymentPlans": {
                        "pp-0Ek5Na02vCohpPgw": {
                            "price": 49.99
                        },
                        "pp-0Ek2xF0332Eh3-FY": {
                            "price": 39.99
                        },
                        "pp-0Ek2zH0332VnSBqZ": {
                            "price": 29.99
                        },
                        "pp-0Ek2HA0334w6CXbl": {
                            "price": 19.99
                        },
                        "pp-0Ek2Ik0334Dio8u_": {
                            "price": 9.99
                        },
                        "pp-0EkadV034j3RVWIw": {
                            "price": 2499
                        }
                    }
                }
            },
            "devTimeStreamApplication": {
                "config": {
                    "kinesis": {
                        "consumer": {
                            "processor": "TimeEventProcessor.js",
                            "appName": "devTimeStreamApplication"
                        },
                        "producer": {
                            "region": "us-east-1"
                        }
                    },
                    "eventHandlers": {
                        "hourly": {
                            "actions": [
                                {
                                    "name": "fetch_campaigns",
                                    "options": {
                                        "statuses": ["active", "paused", "outOfBudget"],
                                        "prefix": "hourly",
                                        "analytics": true,
                                        "number": 50
                                    }
                                },
                                {
                                    "name": "fetch_orgs",
                                    "options": {
                                        "prefix": "hourly"
                                    }
                                }
                            ]
                        },
                        "daily": {
                            "actions": [
                                {
                                    "name": "fetch_orgs",
                                    "options": {
                                        "prefix": "daily"
                                    }
                                }
                            ]
                        }
                    }
                }
            },
            "devWatchmanStreamApplication": {
                "config": {
                    "kinesis": {
                        "consumer": {
                            "processor": "WatchmanEventProcessor.js",
                            "appName": "devWatchmanStreamApplication"
                        },
                        "producer": {
                            "region": "us-east-1"
                        }
                    },
                    "eventHandlers": {
                        "daily_orgPulse": {
                            "actions": ["check_payment_required"]
                        },
                        "hourly_campaignPulse": {
                            "actions": ["check_expiry"]
                        },
                        "hourly_orgPulse": {
                            "actions": ["check_available_funds"]
                        },
                        "campaignOutOfFunds": {
                            "actions": [
                                {
                                    "name": "message/log",
                                    "options": {
                                        "text": "[activity] Campaign {{campaign.name}} ({{campaign.id}}) is out of funds",
                                        "level": "warn"
                                    }
                                }
                            ]
                        },
                        "campaignExpired": {
                            "actions": [
                                {
                                    "name": "set_status",
                                    "options": {
                                        "status": "expired"
                                    }
                                }
                            ]
                        },
                        "campaignReachedBudget": {
                            "actions": [
                                {
                                    "name": "set_status",
                                    "options": {
                                        "status": "outOfBudget"
                                    }
                                }
                            ]
                        },
                        "paymentRequired": {
                            "actions": [
                                {
                                    "name": "charge_payment_plan",
                                    "options": {
                                        "target": "bob"
                                    }
                                }
                            ]
                        },
                        "chargePaymentPlanFailure": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "chargePaymentPlanFailure"
                                    }
                                }
                            ]
                        },
                        "promotionFulfilled": {
                            "actions": [
                                {
                                    "name": "create_promotion_credit"
                                }
                            ]
                        }
                    }
                }
            },
            "devCwrxStreamApplication": {
                "config": {
                    "kinesis": {
                        "consumer": {
                            "processor": "CwrxEventProcessor.js",
                            "appName": "devCwrxStreamApplication"
                        },
                        "producer": {
                            "region": "us-east-1"
                        }
                    },
                    "eventHandlers": {
                        "campaignStateChange": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "campaignExpired"
                                    },
                                    "ifData": {
                                        "previousState": "active|paused",
                                        "currentState": "expired"
                                    }
                                },
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "campaignReachedBudget"
                                    },
                                    "ifData": {
                                        "currentState": "outOfBudget"
                                    }
                                }
                            ]
                        },
                        "campaignApproved": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "campaignApproved"
                                    }
                                }
                            ]
                        },
                        "campaignUpdateApproved": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "campaignUpdateApproved"
                                    }
                                }
                            ]
                        },
                        "campaignRejected": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "campaignRejected"
                                    }
                                }
                            ]
                        },
                        "campaignUpdateRejected": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "campaignUpdateRejected"
                                    }
                                }
                            ]
                        },
                        "newUpdateRequest": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "toSupport": true,
                                        "type": "newUpdateRequest"
                                    }
                                }
                            ]
                        },
                        "paymentMade": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "paymentMade"
                                    }
                                }
                            ]
                        },
                        "accountCreated": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "activateAccount"
                                    }
                                }
                            ]
                        },
                        "accountActivated": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "accountWasActivated"
                                    }
                                },
                                {
                                    "name": "check_signup_promotion"
                                }
                            ]
                        },
                        "passwordChanged": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "passwordChanged"
                                    }
                                }
                            ]
                        },
                        "emailChanged": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "emailChanged"
                                    }
                                }
                            ]
                        },
                        "failedLogins": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "failedLogins"
                                    }
                                }
                            ]
                        },
                        "forgotPassword": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "forgotPassword"
                                    }
                                }
                            ]
                        },
                        "resendActivation": {
                            "actions": [
                                {
                                    "name": "message/campaign_email",
                                    "options": {
                                        "type": "activateAccount"
                                    }
                                }
                            ]
                        }
                    }
                }
            }
        }
    }
}
